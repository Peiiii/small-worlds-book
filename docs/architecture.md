# 项目架构设计

## 依赖关系设计

项目采用分层架构设计，依赖关系如下：

```
main/App (入口层)
    ↓
{core, features} (业务层)
    ↓
shared (基础设施层)
```

### 各层职责

1. **入口层 (main/App)**
   - 应用入口
   - 只依赖业务层（core 和 features）
   - 负责组装和初始化应用

2. **业务层 (core, features)**
   - core：全局核心功能
     - 全局状态管理
     - 全局配置
     - 全局功能（如音乐播放器）
     - 全局工具栏
   - features：具体业务功能
     - 世界系统
     - 角色系统
     - 故事系统
   - 依赖基础设施层（shared）

3. **基础设施层 (shared)**
   - UI 组件库
   - 通用工具函数
   - 通用类型定义
   - 通用 hooks
   - 不依赖其他层

### 设计原则

1. **单向依赖**
   - 上层可以依赖下层
   - 下层不能依赖上层
   - 避免循环依赖

2. **关注点分离**
   - 每层有明确的职责
   - 层与层之间通过接口通信
   - 降低耦合度

3. **可维护性**
   - 清晰的依赖关系
   - 模块化的设计
   - 易于测试和扩展

### 目录结构

```
src/
├── main/              # 入口层
│   ├── App.tsx
│   └── main.tsx
├── core/             # 核心功能
│   ├── components/
│   ├── store/
│   └── config/
├── features/         # 业务功能
│   ├── world/
│   ├── character/
│   └── story/
└── shared/          # 基础设施
    ├── components/
    ├── hooks/
    ├── types/
    └── utils/
``` 